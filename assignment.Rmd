---
title: 'Homework #3'
author: "Michael Munguia"
date: "10/17/2021"
output: html_document
---

```{r setup, include=FALSE,}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
```


```{r}
library(tidyverse)

loans <- read_csv("Loan_approval.csv", show_col_types = FALSE)
```


# Section 1: Exploratory data analysis

```{r}
cont_vars <- c(
  "ApplicantIncome", "CoapplicantIncome", "LoanAmount", "Loan_Amount_Term"
  )

disc_vars <- c(
  "Gender", "Married", "Dependents", "Education", "Self_Employed", 
  "Property_Area"
  )
```

Surveying the continuous variables available, we see that applicant/co-applicants' incomes and loan amounts share similarly right-skewed distributions, with the two income variables being more extreme in their skew. These three variables share a sense of scale (i.e. they refer to monetary amounts and two are incomes) whereas the loan term is on a different scale and measurement (months) along with its displaying a left-skewed distribution.

```{r}
pivot_longer(loans, all_of(cont_vars)) %>% 
  ggplot(aes(value, color = Loan_Status)) +
  geom_freqpoly() +
  facet_wrap("name", scales = "free") +
  scale_x_continuous(labels = scales::comma_format())
```

Knowing that we will be utilizing linear discriminant analysis downstream, it's important to identify that, with the exception of `Loan_Amount_Term` a `log` transformation can be used to make these variables' distributions follow a more Gaussian shape.

Taking the full data set and visualizing loan status for each discrete variable, we can see some interesting trends. An overwhelming number of the approved loans were awarded to those with no dependents. Graduates and males are also a dominant proportion of loan recipients within their given parameter. The self-employed seem far less likely to receive a loan, while semi-urban applicants seem to enjoy an edge over their suburban and urban counterparts. Married applicants are also at an advantage.

```{r}
long_disc <- loans %>% 
  select(disc_vars, Loan_Status) %>% 
  pivot_longer(all_of(disc_vars)) %>% 
  count(name, value, Loan_Status) %>% 
  group_by(name) %>% 
  mutate(total = sum(n)) %>% 
  ungroup() %>% 
  mutate(pct = n / total)


long_disc %>% 
  ggplot(aes(x = value, y = pct, fill = Loan_Status)) +
  geom_col(position = "dodge") +
  scale_y_continuous(breaks = seq(0, 1, 0.1), labels = scales::percent_format(1)) +
  facet_wrap("name", scales = "free")
```

# Section 2: Linear Discriminant Analysis

Assumption here is normal distribution across predictors and same variance among them. Some transformation will may be necessary to achieve closer-to-normal distribution.


# Section 3: K-nearest neighbor



# Section 4: Decision trees



# Section 5: Random forests



# Section 6: Model performance


